<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FS STUDIO - Administration</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet>
</head>
<body>
    <!-- √âcran de connexion -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <div class="login-header">
                <h1>üîê Administration</h1>
                <p>Acc√®s r√©serv√© aux administrateurs</p>
            </div>
            <div class="login-form">
                <input type="password" id="adminCode" placeholder="Code d'acc√®s" autocomplete="off">
                <button id="loginBtn">Se connecter</button>
                <p class="error-message" id="errorMessage" style="display: none;"></p>
            </div>
        </div>
    </div>

    <!-- Interface Admin -->
    <div class="admin-container" id="adminContainer" style="display: none;">
        <header class="admin-header">
            <div class="admin-title">
                <h1>‚öôÔ∏è Administration FS STUDIO</h1>
                <span class="admin-badge" id="userInfo">ADMIN</span>
            </div>
            <button class="logout-btn" id="logoutBtn">D√©connexion</button>
        </header>

        <div class="admin-content">
            <!-- Navigation par onglets -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="site-info">üìä Informations du Site</button>
                <button class="tab-btn" data-tab="broadcasting">üì° Diffusion</button>
                <button class="tab-btn" data-tab="chat">üí¨ Chat</button>
                <button class="tab-btn" data-tab="finance">üí∞ Finance</button>
            </div>

            <!-- Onglet Informations du Site -->
            <div class="tab-content active" id="site-info">
                <!-- Section Statistiques √©tendues -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üìä Statistiques du Site</h2>
                        <div class="real-time-indicator">
                            <span class="pulse-dot"></span>
                            <span>Temps r√©el</span>
                        </div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üí¨</div>
                            <div class="stat-info">
                                <div class="stat-number" id="totalMessages">0</div>
                                <div class="stat-label">Messages totaux</div>
                                <div class="stat-change" id="messagesChange">+0 aujourd'hui</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-info">
                                <div class="stat-number" id="totalUsers">0</div>
                                <div class="stat-label">Utilisateurs uniques</div>
                                <div class="stat-change" id="usersChange">+0 aujourd'hui</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üéôÔ∏è</div>
                            <div class="stat-info">
                                <div class="stat-number" id="listenersCount">0</div>
                                <div class="stat-label">Auditeurs actifs</div>
                                <div class="stat-percentage" id="listenersPercentage">0%</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üü¢</div>
                            <div class="stat-info">
                                <div class="stat-number" id="onlineUsers">0</div>
                                <div class="stat-label">Utilisateurs en ligne</div>
                                <div class="stat-percentage" id="onlinePercentage">0%</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚è±Ô∏è</div>
                            <div class="stat-info">
                                <div class="stat-number" id="uptime">00:00:00</div>
                                <div class="stat-label">Temps de fonctionnement</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìà</div>
                            <div class="stat-info">
                                <div class="stat-number" id="engagementRate">0%</div>
                                <div class="stat-label">Taux d'engagement</div>
                                <div class="stat-change" id="engagementChange">+0%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Graphiques et m√©triques avanc√©es -->
                    <div class="advanced-metrics">
                        <div class="metric-row">
                            <div class="metric-item">
                                <h4>Activit√© par heure</h4>
                                <div class="activity-chart" id="activityChart">
                                    <div class="chart-placeholder">Chargement des donn√©es...</div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <h4>Top messages</h4>
                                <div class="top-messages" id="topMessages">
                                    <div class="message-item">
                                        <span class="message-text">Aucun message r√©cent</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Cr√©ation de Mod√©rateurs (Directeur G√©n√©ral seulement) -->
                <div class="admin-section" id="createModeratorSection" style="display: none;">
                    <div class="section-header">
                        <h2>üëë Gestion des Mod√©rateurs</h2>
                    </div>

                    <div class="moderator-form">
                        <div class="form-group">
                            <label>Nom du mod√©rateur:</label>
                            <input type="text" id="moderatorName" placeholder="Ex: John Doe">
                        </div>
                        <div class="form-group">
                            <label>Label d'affichage:</label>
                            <input type="text" id="moderatorDisplayLabel" placeholder="Ex: STAFF" value="STAFF">
                        </div>
                        <div class="form-group">
                            <label>Code d'acc√®s (6 caract√®res minimum):</label>
                            <input type="text" id="moderatorCode" placeholder="Ex: MOD2024">
                        </div>
                        <div class="form-group">
                            <label>Permissions:</label>
                            <div class="permissions-grid">
                                <label><input type="checkbox" id="permBroadcast" checked> Diffusion</label>
                                <label><input type="checkbox" id="permChat" checked> Chat</label>
                                <label><input type="checkbox" id="permFinance" checked> Finance</label>
                            </div>
                        </div>
                        <button class="action-btn primary" id="createModeratorBtn">‚ûï Cr√©er Mod√©rateur</button>
                    </div>

                    <div class="moderators-list">
                        <h3>Mod√©rateurs Actifs</h3>
                        <div id="moderatorsListContainer">
                            <div class="moderator-item">
                                <span class="moderator-info">Chargement...</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section √âtat du Serveur -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üñ•Ô∏è √âtat du Serveur</h2>
                    </div>
                    <div class="server-status">
                        <div class="status-item">
                            <span class="status-label">WebSocket:</span>
                            <span class="status-value" id="websocketStatus">üîÑ Connexion...</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">Firebase:</span>
                            <span class="status-value" id="firebaseStatus">üîÑ Connexion...</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">Streaming:</span>
                            <span class="status-value" id="streamingStatus">‚è∏Ô∏è Arr√™t√©</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">Derni√®re activit√©:</span>
                            <span class="status-value" id="lastActivity">-</span>
                        </div>
                    </div>
                </div>

                <!-- Section Gestion des Mod√©rateurs (Directeur G√©n√©ral seulement) -->
                <div class="admin-section" id="createModeratorSection" style="display: none;">
                    <div class="section-header">
                        <h2>üëë Gestion des Mod√©rateurs</h2>
                        <p style="font-size: 12px; color: rgba(255,255,255,0.6); margin: 0;">Cr√©er et g√©rer les comptes mod√©rateurs</p>
                    </div>

                    <!-- Cr√©ation de mod√©rateur -->
                    <div class="send-message-form">
                        <div class="form-group">
                            <label>Nom du mod√©rateur:</label>
                            <input type="text" id="moderatorName" placeholder="Ex: Mod√©rateur Chat" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                        </div>
                        <div class="form-group">
                            <label>Label affich√© (dans les parenth√®ses):</label>
                            <input type="text" id="moderatorDisplayLabel" placeholder="Ex: STAFF, MOD, ADMIN..." value="STAFF" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                        </div>
                        <div class="form-group">
                            <label>Code d'acc√®s (auto-g√©n√©r√©):</label>
                            <input type="text" id="moderatorCode" placeholder="G√©n√©r√© automatiquement" readonly style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.5); color: rgba(255,255,255,0.7); font-size: 14px;">
                        </div>
                        <div class="form-group">
                            <label>Permissions:</label>
                            <div style="display: flex; gap: 15px; margin-top: 5px;">
                                <label style="display: flex; align-items: center; gap: 5px; color: rgba(255,255,255,0.8);">
                                    <input type="checkbox" id="moderatorChatPermission" checked> üí¨ Chat
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px; color: rgba(255,255,255,0.8);">
                                    <input type="checkbox" id="moderatorBroadcastPermission"> üì° Diffusion
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px; color: rgba(255,255,255,0.8);">
                                    <input type="checkbox" id="moderatorFinancePermission"> üí∞ Finance
                                </label>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button class="send-btn" id="generateCodeBtn">üé≤ G√©n√©rer Code</button>
                            <button class="send-btn" id="createModeratorBtn">‚úÖ Cr√©er Mod√©rateur</button>
                        </div>
                        <p style="margin-top: 10px; font-size: 12px; color: rgba(255,255,255,0.6);">
                            ‚ö†Ô∏è Le code g√©n√©r√© sera le mot de passe du mod√©rateur. Notez-le bien !
                        </p>
                    </div>

                    <!-- Liste des mod√©rateurs -->
                    <div class="moderator-list" id="moderatorList" style="margin-top: 20px;">
                        <!-- Les mod√©rateurs seront affich√©s ici -->
                    </div>
                </div>
            </div>

            <!-- Section Programmation et Contact -->
            <div class="admin-section">
                <div class="section-header">
                    <h2>üìÖ Programmation & Contact</h2>
                </div>

                <!-- Horaires de diffusion -->
                <div class="schedule-section">
                    <h3>Horaires de Diffusion</h3>
                    <div class="schedule-editor">
                        <div class="form-group">
                            <label>Jour:</label>
                            <select id="scheduleDay">
                                <option value="Tous les jours">Tous les jours</option>
                                <option value="Lundi">Lundi</option>
                                <option value="Mardi">Mardi</option>
                                <option value="Mercredi">Mercredi</option>
                                <option value="Jeudi">Jeudi</option>
                                <option value="Vendredi">Vendredi</option>
                                <option value="Samedi">Samedi</option>
                                <option value="Dimanche">Dimanche</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Heure de d√©but:</label>
                            <input type="time" id="scheduleStart" value="14:00">
                        </div>
                        <div class="form-group">
                            <label>Heure de fin:</label>
                            <input type="time" id="scheduleEnd" value="16:00">
                        </div>
                        <div class="form-actions">
                            <button class="save-btn" id="saveScheduleBtn">üíæ Sauvegarder Horaires</button>
                        </div>
                    </div>
                    <div class="schedule-display">
                        <div class="schedule-item">
                            <span class="schedule-day" id="currentScheduleDay">Tous les jours</span>
                            <span class="schedule-time" id="currentScheduleTime">14h00 - 16h00</span>
                            <span class="schedule-status">üü¢ Actif</span>
                        </div>
                    </div>
                </div>

                <!-- Informations de contact -->
                <div class="contact-section">
                    <h3>Informations de Contact</h3>
                    <div class="contact-form">
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="contactEmail" value="contact@fsstudio.com">
                        </div>
                        <div class="form-group">
                            <label>Site web:</label>
                            <input type="url" id="contactWebsite" value="www.fsstudio.com">
                        </div>
                        <div class="form-group">
                            <label>T√©l√©phone:</label>
                            <input type="tel" id="contactPhone" value="+33 1 23 45 67 89">
                        </div>
                        <div class="form-group">
                            <label>Adresse:</label>
                            <textarea id="contactAddress" rows="2">123 Rue de la Radio, 75001 Paris, France</textarea>
                        </div>
                        <div class="form-actions">
                            <button class="save-btn" id="saveContactBtn">üíæ Sauvegarder Contact</button>
                        </div>
                    </div>
                </div>

                <!-- Statistiques de diffusion -->
                <div class="broadcast-stats">
                    <h3>Statistiques de Diffusion</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">‚è∞</div>
                            <div class="stat-info">
                                <div class="stat-number" id="broadcastHours">2h</div>
                                <div class="stat-label">Dur√©e quotidienne</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-info">
                                <div class="stat-number" id="broadcastDays">7/7</div>
                                <div class="stat-label">Jours par semaine</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üéØ</div>
                            <div class="stat-info">
                                <div class="stat-number" id="broadcastReach">0</div>
                                <div class="stat-label">Audience cumul√©e</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Onglet Diffusion -->
            <div class="tab-content" id="broadcasting">
                <!-- Configuration URL Stream -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üì° Configuration Stream Audio</h2>
                    </div>
                    <div class="send-message-form">
                        <div class="form-group">
                            <label>URL du Stream Audio (ex: https://stream.example.com/radio.mp3):</label>
                            <input type="text" id="streamUrlInput" placeholder="https://..." style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                        </div>
                        <div class="form-actions">
                            <button class="send-btn" id="saveStreamUrlBtn">üíæ Enregistrer l'URL</button>
                        </div>
                        <p style="margin-top: 10px; font-size: 12px; color: rgba(255,255,255,0.6);">
                            ‚ö†Ô∏è Si une URL est configur√©e, elle sera utilis√©e au lieu du streaming vocal direct. Laissez vide pour utiliser le streaming vocal.
                        </p>
                    </div>

                    <!-- Option simple : Fichier MP3 local -->
                    <div class="send-message-form" style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
                        <div class="form-group">
                            <label>üéµ OU : Diffuser un fichier MP3 directement (plus simple !)</label>
                            <input type="file" id="mp3FileInput" accept="audio/mp3,audio/*" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                            <p style="margin-top: 5px; font-size: 11px; color: rgba(255,255,255,0.5);">
                                S√©lectionnez un fichier MP3 de votre ordinateur. Il sera diffus√© automatiquement sur le site !
                            </p>
                        </div>
                        <div class="form-actions">
                            <button class="send-btn" id="startMp3StreamBtn">‚ñ∂Ô∏è D√©marrer la diffusion MP3</button>
                            <button class="send-btn" id="stopMp3StreamBtn" style="display: none; background: #f04747;">‚èπÔ∏è Arr√™ter la diffusion</button>
                        </div>
                        <p id="mp3StreamStatus" style="margin-top: 10px; font-size: 12px; color: rgba(255,255,255,0.6);"></p>
                    </div>
                </div>

                <!-- Section Profils Audio -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üéµ Profils Audio - Qualit√© Optimis√©e</h2>
                    </div>
                    <div class="audio-profiles">
                        <div class="profile-selector">
                            <label>Profil Audio:</label>
                            <select id="audioProfileSelect" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                                <option value="broadcast">üì° Broadcast (48kHz St√©r√©o) - Qualit√© radio professionnelle</option>
                                <option value="music">üéµ Musique (44.1kHz St√©r√©o) - Qualit√© CD pour musique</option>
                                <option value="voice">üéôÔ∏è Voix (16kHz Mono) - Optimis√© pour la parole</option>
                            </select>
                        </div>
                        <div class="profile-info" id="profileInfo" style="margin-top: 15px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px; border: 1px solid rgba(255,255,255,0.1);">
                            <h4 style="margin: 0 0 10px 0; color: #43b581;">üì° Broadcast (48kHz St√©r√©o)</h4>
                            <p style="margin: 0; font-size: 13px; color: rgba(255,255,255,0.8);">
                                Profil optimis√© pour la diffusion radio professionnelle avec latence minimale et qualit√© broadcast.
                            </p>
                        </div>
                        <div class="audio-quality-indicator" style="margin-top: 15px; text-align: center;">
                            <div class="quality-meter">
                                <span class="quality-label">Qualit√© Audio: </span>
                                <span class="quality-value" id="qualityValue">EXCELLENTE</span>
                            </div>
                            <div class="quality-bar" style="margin-top: 10px; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
                                <div class="quality-fill" id="qualityFill" style="height: 100%; background: linear-gradient(90deg, #f04747, #faa61a, #43b581); width: 95%; border-radius: 4px;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Contr√¥les Audio Avanc√©s -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üéöÔ∏è Contr√¥les Audio Avanc√©s</h2>
                    </div>
                    <div class="audio-controls-grid">
                        <div class="control-group">
                            <label>üéõÔ∏è √âgaliseur</label>
                            <div class="eq-controls">
                                <div class="eq-slider">
                                    <label>Basses (250Hz)</label>
                                    <input type="range" id="eqLowGain" min="-10" max="10" step="0.1" value="2.0">
                                    <span id="eqLowGainValue">2.0 dB</span>
                                </div>
                                <div class="eq-slider">
                                    <label>M√©diums (3kHz)</label>
                                    <input type="range" id="eqMidGain" min="-10" max="10" step="0.1" value="3.0">
                                    <span id="eqMidGainValue">3.0 dB</span>
                                </div>
                                <div class="eq-slider">
                                    <label>Aigus (8kHz)</label>
                                    <input type="range" id="eqHighGain" min="-10" max="10" step="0.1" value="2.5">
                                    <span id="eqHighGainValue">2.5 dB</span>
                                </div>
                            </div>
                        </div>

                        <div class="control-group">
                            <label>üéöÔ∏è Compression</label>
                            <div class="compressor-controls">
                                <div class="compressor-slider">
                                    <label>Seuil</label>
                                    <input type="range" id="compressorThreshold" min="-40" max="0" step="1" value="-20">
                                    <span id="compressorThresholdValue">-20 dB</span>
                                </div>
                                <div class="compressor-slider">
                                    <label>Ratio</label>
                                    <input type="range" id="compressorRatio" min="1" max="20" step="0.5" value="4">
                                    <span id="compressorRatioValue">4:1</span>
                                </div>
                            </div>
                        </div>

                        <div class="control-group">
                            <label>üéöÔ∏è Effets Sp√©ciaux</label>
                            <div class="effects-controls">
                                <div class="effect-toggle">
                                    <label>
                                        <input type="checkbox" id="stereoEnhancement" checked>
                                        Am√©lioration St√©r√©o
                                    </label>
                                </div>
                                <div class="effect-slider">
                                    <label>R√©verb√©ration</label>
                                    <input type="range" id="reverbMix" min="0" max="0.3" step="0.01" value="0.1">
                                    <span id="reverbMixValue">10%</span>
                                </div>
                                <div class="effect-slider">
                                    <label>Porte de Bruit</label>
                                    <input type="range" id="noiseGateThreshold" min="-60" max="-20" step="1" value="-45">
                                    <span id="noiseGateThresholdValue">-45 dB</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="audio-actions" style="margin-top: 20px; display: flex; gap: 10px;">
                        <button class="action-btn primary" id="applyAudioSettings">‚úÖ Appliquer les r√©glages</button>
                        <button class="action-btn info" id="resetAudioSettings">üîÑ R√©initialiser</button>
                        <button class="action-btn warning" id="testAudioSettings">üéß Tester l'audio</button>
                    </div>
                </div>

                <!-- Section Radio / Streaming -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üéôÔ∏è Radio / Streaming</h2>
                        <div class="radio-status" id="radioStatus">
                            <span class="status-indicator" id="radioStatusIndicator"></span>
                            <span id="radioStatusText">Hors ligne</span>
                        </div>
                    </div>

                    <!-- Contr√¥les de diffusion vocale -->
                    <div class="voice-controls">
                        <button class="voice-btn" id="startVoiceBtn">üé§ D√©marrer la diffusion vocale</button>
                        <button class="voice-btn" id="stopVoiceBtn" style="display: none;">‚èπÔ∏è Arr√™ter la diffusion</button>
                    </div>

                    <div class="voice-info" id="voiceInfo" style="display: none;">
                        <div class="info-item">
                            <span class="info-label">Statut:</span>
                            <span class="info-value" id="voiceStatusText">Initialisation...</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Niveau audio:</span>
                            <span class="info-value">
                                <div class="audio-level-bar">
                                    <div class="audio-level-fill" id="audioLevel"></div>
                                </div>
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Auditeurs:</span>
                            <span class="info-value" id="listenersCount">0</span>
                        </div>
                    </div>

                    <!-- Statistiques du stream -->
                    <div class="stream-stats" id="streamStats" style="display: none;">
                        <div class="stat-item">
                            <span class="stat-label">Chunks envoy√©s:</span>
                            <span class="stat-value" id="chunksSent">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Dernier envoi:</span>
                            <span class="stat-value" id="lastSent">-</span>
                        </div>
                    </div>
                </div>
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üéôÔ∏è Radio / Streaming</h2>
                        <div class="radio-status" id="radioStatus">
                            <span class="status-indicator" id="radioStatusIndicator"></span>
                            <span id="radioStatusText">Hors ligne</span>
                        </div>
                    </div>

                    <!-- Info importante -->
                    <div class="radio-info-box">
                        <h4>üì¢ Diffusion vocale en direct</h4>
                        <p>Ce syst√®me diffuse votre voix directement sur le site, sans serveur externe n√©cessaire.</p>
                        <ul>
                            <li>‚úÖ Aucune configuration requise</li>
                            <li>‚úÖ Diffusion en temps r√©el</li>
                            <li>‚úÖ Accessible √† tous les visiteurs</li>
                            <li>‚úÖ Qualit√© audio optimis√©e</li>
                        </ul>
                    </div>

                    <!-- Contr√¥le vocal en direct -->
                    <div class="voice-control">
                        <div class="voice-header">
                            <h3>üé§ Diffusion vocale en direct</h3>
                        </div>
                        <div class="voice-controls">
                            <button class="voice-btn" id="startVoiceBtn">
                                <span class="voice-icon">üé§</span>
                                <span>D√©marrer la diffusion</span>
                            </button>
                            <button class="voice-btn stop" id="stopVoiceBtn" style="display: none;">
                                <span class="voice-icon">‚èπÔ∏è</span>
                                <span>Arr√™ter la diffusion</span>
                            </button>
                        </div>
                        <div class="voice-info" id="voiceInfo" style="display: none;">
                            <div class="voice-meter">
                                <div class="meter-label">Niveau audio:</div>
                                <div class="meter-bar">
                                    <div class="meter-fill" id="audioLevel"></div>
                                </div>
                            </div>
                            <div class="audio-quality-info">
                                <div class="quality-badge">üéöÔ∏è Normalisation active</div>
                                <div class="quality-badge">üîá Suppression de bruit</div>
                                <div class="quality-badge">üéõÔ∏è Compression audio</div>
                            </div>
                            <p class="voice-status-text" id="voiceStatusText">En attente de permission microphone...</p>
                            <div class="stream-stats" id="streamStats" style="display: none;">
                                <div class="stat-row">
                                    <span>Chunks envoy√©s:</span>
                                    <span id="chunksSent">0</span>
                                </div>
                                <div class="stat-row">
                                    <span>Dernier envoi:</span>
                                    <span id="lastSent">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Instructions -->
                    <div class="radio-instructions">
                        <h4>üìã Comment utiliser:</h4>
                        <ol>
                            <li>Cliquez sur "D√©marrer la diffusion" ci-dessous</li>
                            <li>Autorisez l'acc√®s au microphone dans votre navigateur</li>
                            <li>Parlez normalement - votre voix sera diffus√©e en direct</li>
                            <li>Les visiteurs du site entendront votre voix en temps r√©el</li>
                            <li>Cliquez sur "Arr√™ter" pour mettre fin √† la diffusion</li>
                        </ol>
                        <p class="info-note">üí° <strong>Astuce:</strong> Assurez-vous d'avoir un bon micro et un environnement calme pour une meilleure qualit√© audio.</p>
                    </div>
                </div>

                <!-- Section Contr√¥le Audio en Temps R√©el -->
                <div class="admin-section" id="audioControlSection">
                    <div class="section-header">
                        <h2>üéõÔ∏è Contr√¥le Audio en Temps R√©el</h2>
                        <div class="audio-control-actions">
                            <button class="action-btn" id="resetAudioParamsBtn">üîÑ R√©initialiser</button>
                            <button class="action-btn" id="saveAudioParamsBtn">üíæ Sauvegarder</button>
                        </div>
                    </div>

                    <div class="audio-control-panel">
                        <!-- Filtres -->
                        <div class="audio-control-group">
                            <h3>üîä Filtres</h3>
                            <div class="control-row">
                                <label>High-Pass (Hz): <span id="audio-highPassFreq-display">50 Hz</span></label>
                                <input type="range" id="audio-highPassFreq" min="20" max="200" step="1" value="50">
                            </div>
                            <div class="control-row">
                                <label>Low-Pass (Hz): <span id="audio-lowPassFreq-display">15000 Hz</span></label>
                                <input type="range" id="audio-lowPassFreq" min="5000" max="20000" step="100" value="15000">
                            </div>
                        </div>

                        <!-- Pr√©-emphasis -->
                        <div class="audio-control-group">
                            <h3>üìà Pr√©-emphasis FM</h3>
                            <div class="control-row">
                                <label>Gain (dB): <span id="audio-preEmphasisGain-display">+3.0 dB</span></label>
                                <input type="range" id="audio-preEmphasisGain" min="0" max="10" step="0.1" value="3">
                            </div>
                            <div class="control-row">
                                <label>Fr√©quence (Hz): <span id="audio-preEmphasisFreq-display">3000 Hz</span></label>
                                <input type="range" id="audio-preEmphasisFreq" min="1000" max="8000" step="100" value="3000">
                            </div>
                        </div>

                        <!-- √âgaliseur -->
                        <div class="audio-control-group">
                            <h3>üéöÔ∏è √âgaliseur</h3>
                            <div class="eq-band">
                                <h4>Basse (200Hz)</h4>
                                <div class="control-row">
                                    <label>Fr√©quence (Hz): <span id="audio-eqLowFreq-display">200 Hz</span></label>
                                    <input type="range" id="audio-eqLowFreq" min="50" max="500" step="10" value="200">
                                </div>
                                <div class="control-row">
                                    <label>Gain (dB): <span id="audio-eqLowGain-display">+1.5 dB</span></label>
                                    <input type="range" id="audio-eqLowGain" min="-10" max="10" step="0.1" value="1.5">
                                </div>
                                <div class="control-row">
                                    <label>Q: <span id="audio-eqLowQ-display">1.00</span></label>
                                    <input type="range" id="audio-eqLowQ" min="0.1" max="5" step="0.1" value="1.0">
                                </div>
                            </div>
                            <div class="eq-band">
                                <h4>M√©dium (2kHz)</h4>
                                <div class="control-row">
                                    <label>Fr√©quence (Hz): <span id="audio-eqMidFreq-display">2000 Hz</span></label>
                                    <input type="range" id="audio-eqMidFreq" min="500" max="5000" step="50" value="2000">
                                </div>
                                <div class="control-row">
                                    <label>Gain (dB): <span id="audio-eqMidGain-display">+2.5 dB</span></label>
                                    <input type="range" id="audio-eqMidGain" min="-10" max="10" step="0.1" value="2.5">
                                </div>
                                <div class="control-row">
                                    <label>Q: <span id="audio-eqMidQ-display">1.20</span></label>
                                    <input type="range" id="audio-eqMidQ" min="0.1" max="5" step="0.1" value="1.2">
                                </div>
                            </div>
                            <div class="eq-band">
                                <h4>Haute (6kHz)</h4>
                                <div class="control-row">
                                    <label>Fr√©quence (Hz): <span id="audio-eqHighFreq-display">6000 Hz</span></label>
                                    <input type="range" id="audio-eqHighFreq" min="2000" max="12000" step="100" value="6000">
                                </div>
                                <div class="control-row">
                                    <label>Gain (dB): <span id="audio-eqHighGain-display">+2.0 dB</span></label>
                                    <input type="range" id="audio-eqHighGain" min="-10" max="10" step="0.1" value="2">
                                </div>
                                <div class="control-row">
                                    <label>Q: <span id="audio-eqHighQ-display">1.00</span></label>
                                    <input type="range" id="audio-eqHighQ" min="0.1" max="5" step="0.1" value="1.0">
                                </div>
                            </div>
                        </div>

                        <!-- Compresseur -->
                        <div class="audio-control-group">
                            <h3>üéöÔ∏è Compresseur</h3>
                            <div class="control-row">
                                <label>Seuil (dB): <span id="audio-compressorThreshold-display">-18.0 dB</span></label>
                                <input type="range" id="audio-compressorThreshold" min="-60" max="0" step="1" value="-18">
                            </div>
                            <div class="control-row">
                                <label>Knee (dB): <span id="audio-compressorKnee-display">15.0 dB</span></label>
                                <input type="range" id="audio-compressorKnee" min="0" max="40" step="1" value="15">
                            </div>
                            <div class="control-row">
                                <label>Ratio: <span id="audio-compressorRatio-display">3.0:1</span></label>
                                <input type="range" id="audio-compressorRatio" min="1" max="20" step="0.1" value="3">
                            </div>
                            <div class="control-row">
                                <label>Attack (ms): <span id="audio-compressorAttack-display">3.0 ms</span></label>
                                <input type="range" id="audio-compressorAttack" min="0.001" max="0.1" step="0.001" value="0.003">
                            </div>
                            <div class="control-row">
                                <label>Release (ms): <span id="audio-compressorRelease-display">150.0 ms</span></label>
                                <input type="range" id="audio-compressorRelease" min="0.01" max="1" step="0.01" value="0.15">
                            </div>
                        </div>

                        <!-- AGC -->
                        <div class="audio-control-group">
                            <h3>üîä AGC (Auto Gain Control)</h3>
                            <div class="control-row">
                                <label>Gain: <span id="audio-agcGain-display">1.00</span></label>
                                <input type="range" id="audio-agcGain" min="0.1" max="2" step="0.01" value="1.0">
                            </div>
                        </div>

                        <!-- Limiter -->
                        <div class="audio-control-group">
                            <h3>üõ°Ô∏è Limiter</h3>
                            <div class="control-row">
                                <label>Seuil (dB): <span id="audio-limiterThreshold-display">-0.3 dB</span></label>
                                <input type="range" id="audio-limiterThreshold" min="-3" max="0" step="0.1" value="-0.3">
                            </div>
                            <div class="control-row">
                                <label>Knee (dB): <span id="audio-limiterKnee-display">0.0 dB</span></label>
                                <input type="range" id="audio-limiterKnee" min="0" max="10" step="0.1" value="0">
                            </div>
                            <div class="control-row">
                                <label>Ratio: <span id="audio-limiterRatio-display">20.0:1</span></label>
                                <input type="range" id="audio-limiterRatio" min="5" max="30" step="0.1" value="20">
                            </div>
                            <div class="control-row">
                                <label>Attack (ms): <span id="audio-limiterAttack-display">1.0 ms</span></label>
                                <input type="range" id="audio-limiterAttack" min="0.001" max="0.01" step="0.001" value="0.001">
                            </div>
                            <div class="control-row">
                                <label>Release (ms): <span id="audio-limiterRelease-display">50.0 ms</span></label>
                                <input type="range" id="audio-limiterRelease" min="0.01" max="0.2" step="0.01" value="0.05">
                            </div>
                        </div>

                        <!-- De-emphasis -->
                        <div class="audio-control-group">
                            <h3>üìâ De-emphasis</h3>
                            <div class="control-row">
                                <label>Gain (dB): <span id="audio-deEmphasisGain-display">-1.0 dB</span></label>
                                <input type="range" id="audio-deEmphasisGain" min="-5" max="0" step="0.1" value="-1">
                            </div>
                            <div class="control-row">
                                <label>Fr√©quence (Hz): <span id="audio-deEmphasisFreq-display">3000 Hz</span></label>
                                <input type="range" id="audio-deEmphasisFreq" min="1000" max="8000" step="100" value="3000">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        <!-- Onglet Chat -->
            <div class="tab-content" id="chat">
                <!-- Section Chat Management -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üí¨ Gestion du Chat</h2>
                        <div class="online-stats">
                            <span class="stat-item">
                                <span class="stat-label">En ligne:</span>
                                <span class="stat-value" id="adminOnlineCount">0</span>
                            </span>
                        </div>
                    </div>

                    <!-- Zone de messages avec mod√©ration -->
                    <div class="chat-admin-container">
                        <div class="chat-messages-admin" id="chatMessagesAdmin">
                            <div class="loading-message">Chargement des messages...</div>
                        </div>
                    </div>

                    <!-- Actions rapides -->
                    <div class="admin-actions">
                        <button class="action-btn danger" id="clearAllBtn">üóëÔ∏è Supprimer tous les messages</button>
                        <button class="action-btn" id="refreshBtn">üîÑ Actualiser</button>
                    </div>
                </div>

                <!-- Section Envoyer un message -->
                <div class="admin-section">
                    <div class="section-header">
                        <h2>üì¢ Envoyer un message</h2>
                    </div>
                    <div class="send-message-form">
                        <div class="form-group">
                            <label>Nom d'affichage:</label>
                            <input type="text" id="adminUsername" value="Admin FS Studio" maxlength="20">
                        </div>
                        <div class="form-group">
                            <label>Message:</label>
                            <textarea id="adminMessage" placeholder="Tapez votre message..." maxlength="500" rows="3"></textarea>
                        </div>
                        <div class="form-actions">
                            <button class="send-btn" id="adminSendBtn">üì§ Envoyer</button>
                            <span class="char-count"><span id="charCount">0</span>/500</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Onglet Finance -->
        <div class="tab-content" id="finance">
            <div class="finance-dashboard">
                <!-- M√©triques financi√®res principales -->
                <div class="finance-metrics-grid">
                    <div class="metric-card revenue">
                        <div class="metric-icon">üí∞</div>
                        <div class="metric-content">
                            <div class="metric-value">$0.00</div>
                            <div class="metric-label">Revenus totaux</div>
                            <div class="metric-change">+0.00 (30j)</div>
                        </div>
                    </div>

                    <div class="metric-card expenses">
                        <div class="metric-icon">üí∏</div>
                        <div class="metric-content">
                            <div class="metric-value">$0.00</div>
                            <div class="metric-label">D√©penses totales</div>
                            <div class="metric-change">+0.00 (30j)</div>
                        </div>
                    </div>

                    <div class="metric-card profit">
                        <div class="metric-icon">üìà</div>
                        <div class="metric-content">
                            <div class="metric-value">$0.00</div>
                            <div class="metric-label">B√©n√©fice net</div>
                            <div class="metric-change">+0.00 (30j)</div>
                        </div>
                    </div>

                    <div class="metric-card roi">
                        <div class="metric-icon">üéØ</div>
                        <div class="metric-content">
                            <div class="metric-value">0.0%</div>
                            <div class="metric-label">ROI</div>
                            <div class="metric-change">+0.0% (30j)</div>
                        </div>
                    </div>
                </div>

                <!-- Graphiques financiers -->
                <div class="finance-charts">
                    <div class="chart-container">
                        <h3>üìä Revenus par Source</h3>
                        <div class="chart-placeholder">
                            <div class="chart-bar" data-value="$0.00" style="height: 20%"></div>
                            <div class="chart-bar" data-value="$0.00" style="height: 40%"></div>
                            <div class="chart-bar" data-value="$0.00" style="height: 60%"></div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3>üìà R√©partition des D√©penses</h3>
                        <div class="pie-chart">
                            <div class="pie-center">
                                <div class="pie-value">$0.00</div>
                                <div class="pie-label">Total</div>
                            </div>
                        </div>
                        <div class="pie-legend">
                            <div class="legend-item">
                                <div class="legend-color server"></div>
                                <div class="legend-label">Serveur</div>
                                <div class="legend-value">$0.00 (0.0%)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color marketing"></div>
                                <div class="legend-label">Marketing</div>
                                <div class="legend-value">$0.00 (0.0%)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color staff"></div>
                                <div class="legend-label">Staff</div>
                                <div class="legend-value">$0.00 (0.0%)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color other"></div>
                                <div class="legend-label">Autre</div>
                                <div class="legend-value">$0.00 (0.0%)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Transactions -->
                <div class="transactions-section">
                    <div class="section-header">
                        <h3>üìã Historique des Transactions</h3>
                        <div class="transaction-filters">
                            <select id="transaction-type-filter" class="filter-select">
                                <option value="all">Toutes les transactions</option>
                                <option value="revenue">Revenus</option>
                                <option value="expense">D√©penses</option>
                                <option value="transfer">Transferts</option>
                            </select>
                            <select id="transaction-sort" class="sort-select">
                                <option value="date-desc">Plus r√©cent</option>
                                <option value="date-asc">Plus ancien</option>
                                <option value="amount-desc">Montant ‚Üì</option>
                                <option value="amount-asc">Montant ‚Üë</option>
                            </select>
                        </div>
                    </div>

                    <div class="transactions-table">
                        <div class="transaction-header">
                            <div class="transaction-col">Date</div>
                            <div class="transaction-col">Type</div>
                            <div class="transaction-col">Description</div>
                            <div class="transaction-col">Montant</div>
                            <div class="transaction-col">Cat√©gorie</div>
                        </div>
                        <div class="transaction-body">
                            <div class="transaction-row empty">Aucune transaction trouv√©e</div>
                        </div>
                    </div>
                </div>

                <!-- Section Budgets -->
                <div class="budget-section">
                    <div class="section-header">
                        <h3>üéØ Gestion des Budgets</h3>
                        <button class="action-btn primary" onclick="createBudget('Nouveau Budget', 100)">‚ûï Nouveau Budget</button>
                    </div>

                    <div class="budgets-grid">
                        <!-- Les budgets seront ajout√©s dynamiquement -->
                    </div>
                </div>

                <!-- Section Portefeuilles -->
                <div class="wallets-section">
                    <div class="section-header">
                        <h3>üë• Gestion des Portefeuilles</h3>
                        <div class="wallets-controls">
                            <div class="search-filter">
                                <input type="text" id="wallet-search" placeholder="Rechercher un utilisateur..." class="search-input">
                            </div>
                        </div>
                    </div>

                    <div class="wallets-list">
                        <!-- Les portefeuilles seront ajout√©s dynamiquement -->
                    </div>
                </div>

                <!-- Actions Administratives Financi√®res -->
                <div class="admin-financial-actions">
                    <div class="section-header">
                        <h3>‚öôÔ∏è Actions Administratives</h3>
                    </div>

                    <div class="admin-actions-grid">
                        <div class="action-card">
                            <h4>üí∞ Gestion des Revenus</h4>
                            <div class="action-buttons">
                                <button class="action-btn success" onclick="addRevenue(prompt('Montant:'), 'streaming', prompt('Description:'))">‚ûï Ajouter Revenus</button>
                                <button class="action-btn info" onclick="generateFinancialReport()">üìä Rapport</button>
                            </div>
                        </div>

                        <div class="action-card">
                            <h4>üí∏ Gestion des D√©penses</h4>
                            <div class="action-buttons">
                                <button class="action-btn warning" onclick="addExpense(prompt('Montant:'), 'server', prompt('Description:'))">‚ûñ Ajouter D√©penses</button>
                                <button class="action-btn secondary" onclick="createBudget(prompt('Cat√©gorie:'), prompt('Limite:'))">üéØ Cr√©er Budget</button>
                            </div>
                        </div>

                        <div class="action-card">
                            <h4>üìä Export & Sauvegarde</h4>
                            <div class="action-buttons">
                                <button class="action-btn primary" onclick="exportFinancialData()">üíæ Exporter</button>
                                <button class="action-btn danger" onclick="resetFinancialData()">üîÑ R√©initialiser</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <!-- Modal d'√©dition des mod√©rateurs -->
    <div class="modal" id="editModeratorModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Modifier le Mod√©rateur</h3>
                <span class="modal-close" id="cancelEditModeratorBtn">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editModeratorForm">
                    <div class="form-group">
                        <label>Nom du mod√©rateur:</label>
                        <input type="text" id="editModeratorName" placeholder="Nom du mod√©rateur" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                    </div>
                    <div class="form-group">
                        <label>Label affich√© (dans les parenth√®ses):</label>
                        <input type="text" id="editModeratorDisplayLabel" placeholder="Ex: STAFF, MOD, ADMIN..." style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                    </div>
                    <div class="form-group">
                        <label>Code d'acc√®s:</label>
                        <input type="text" id="editModeratorCode" placeholder="Code d'acc√®s" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                    </div>
                    <div class="form-group">
                        <label>Permissions:</label>
                        <div style="display: flex; gap: 15px; margin-top: 5px;">
                            <label style="display: flex; align-items: center; gap: 5px; color: rgba(255,255,255,0.8);">
                                <input type="checkbox" id="editChatPermission"> üí¨ Chat
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; color: rgba(255,255,255,0.8);">
                                <input type="checkbox" id="editBroadcastPermission"> üì° Diffusion
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; color: rgba(255,255,255,0.8);">
                                <input type="checkbox" id="editFinancePermission"> üí∞ Finance
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="cancel-btn" id="cancelEditModeratorBtn">Annuler</button>
                <button class="save-btn" id="saveEditModeratorBtn">üíæ Sauvegarder</button>
            </div>
        </div>
    </div>

    <!-- Modal d'ajout de fonds -->
    <div class="modal" id="addFinanceModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üí∞ Ajouter des Fonds</h3>
                <span class="modal-close" id="cancelAddFinanceBtn">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addFinanceForm">
                    <div class="form-group">
                        <label>S√©lectionner l'utilisateur:</label>
                        <select id="financeUserSelect" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                            <option value="">Choisir un utilisateur...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Montant √† ajouter (‚Ç¨):</label>
                        <input type="number" id="financeAmount" placeholder="0.00" min="0" step="0.01" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                    </div>
                    <div class="form-group">
                        <label>Description:</label>
                        <input type="text" id="financeDescription" placeholder="Ex: Salaire mensuel, Bonus..." style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; font-size: 14px;">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="cancel-btn" id="cancelAddFinanceBtn">Annuler</button>
                <button class="save-btn" id="saveAddFinanceBtn">üí∞ Ajouter</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <!-- Configuration Firebase -->
    <script src="firebase-config.js"></script>
    
    <!-- Mediasoup Client -->
    <script src="mediasoup-client-admin.js"></script>
    
    <!-- Panneau de contr√¥le audio -->
    <script src="audio-control-panel.js"></script>
    
    <!-- Script Admin -->
    <script src="admin.js"></script>
</body>
</html>

